# Web Comparison Tool - å¿«é€Ÿå¼€å§‹

## æ˜¯ä»€ä¹ˆï¼Ÿ

ä¸€ä¸ª web å¯è§†åŒ–å·¥å…·ï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­å¯¹æ¯”å¤šä¸ªå¤„ç†è¿è¡Œï¼ˆrunï¼‰çš„ç»“æœã€‚

## ä¸ºä»€ä¹ˆéœ€è¦ï¼Ÿ

- ğŸ–¼ï¸ **å¹¶æ’æŸ¥çœ‹å›¾ç‰‡** - å¯¹æ¯”ä¸åŒ run çš„åŸå§‹æ‘„åƒå¤´æ•°æ®
- ğŸ§  **å¯¹æ¯” VLM è¾“å‡º** - æŸ¥çœ‹é“¾å¼æ¨ç†ï¼ˆChain-of-Thoughtï¼‰åˆ†æ
- ğŸ“Š **å¿«é€Ÿè´¨é‡æ£€æŸ¥** - éªŒè¯ä¸åŒé…ç½®çš„æ•ˆæœ
- âš¡ **äº¤äº’å¼æµè§ˆ** - åœ¨ web ä¸­è½»æ¾æµè§ˆæ‰€æœ‰å¸§

## å¿«é€Ÿå¼€å§‹ï¼ˆ3 æ­¥ï¼‰

### 1ï¸âƒ£ å¯åŠ¨æœåŠ¡å™¨

```bash
cd /root/qwen-anno
./start_comparison_server.sh output
```

æˆ–è€…ç›´æ¥è¿è¡Œï¼š

```bash
python compare_runs_web.py --output-dir output
```

### 2ï¸âƒ£ æ‰“å¼€æµè§ˆå™¨

è®¿é—®ï¼š**http://127.0.0.1:5000**

### 3ï¸âƒ£ é€‰æ‹©å’Œå¯¹æ¯”

- âœ“ å‹¾é€‰æƒ³è¦å¯¹æ¯”çš„ run
- ç‚¹å‡» **"Load Comparison"**
- åœ¨ web ä¸­æµè§ˆå¯¹æ¯”ç»“æœ

## é¡µé¢åŠŸèƒ½

### é¡¶éƒ¨æ§åˆ¶åŒº

```
ã€Run Selectionã€‘é€‰æ‹©è¦å¯¹æ¯”çš„ runï¼ˆå¯å¤šé€‰ï¼‰
ã€Load Comparisonã€‘åŠ è½½é€‰ä¸­ run çš„å¯¹æ¯”æ•°æ®
ã€Clearã€‘æ¸…é™¤å½“å‰æ˜¾ç¤º

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯ï¼ˆè‡ªåŠ¨æ˜¾ç¤ºï¼‰
- Common Frames: æ‰€æœ‰ run çš„å…¬å…±å¸§æ•°
- Selected Runs: é€‰ä¸­çš„ run æ•°
- Unique Scenes: ä¸åŒé©¾é©¶åœºæ™¯æ•°
```

### å¸§å¡ç‰‡ï¼ˆFrame Cardï¼‰

æ¯ä¸ªå¸§æ˜¾ç¤ºä¸ºä¸€å¼ å¡ç‰‡ï¼š

```
â”Œâ”€ Frame 1. 0ec2897...e-123 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Scene: 0ec2897...e | Frame ID: 123            â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Run 1        â”‚  â”‚   Run 2        â”‚        â”‚
â”‚  â”‚                â”‚  â”‚                â”‚        â”‚
â”‚  â”‚    [Image]     â”‚  â”‚    [Image]     â”‚        â”‚
â”‚  â”‚  1920x1440px   â”‚  â”‚  1920x1440px   â”‚        â”‚
â”‚  â”‚                â”‚  â”‚                â”‚        â”‚
â”‚  â”‚ Chain-of-      â”‚  â”‚ Chain-of-      â”‚        â”‚
â”‚  â”‚ Thought        â”‚  â”‚ Thought        â”‚        â”‚
â”‚  â”‚ Analysis       â”‚  â”‚ Analysis       â”‚        â”‚
â”‚  â”‚                â”‚  â”‚                â”‚        â”‚
â”‚  â”‚ âœ“ Processed    â”‚  â”‚ âœ“ Processed    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹ 1: éªŒè¯ä¸åŒæ¨¡å‹è¾“å‡º

```bash
# ç”¨ä¸¤ä¸ªä¸åŒçš„ VLM æ¨¡å‹å¤„ç†
python waymo_e2e_processor.py --model-name gpt-4 --run-name run_gpt4
python waymo_e2e_processor.py --model-name claude --run-name run_claude

# å¯¹æ¯”ç»“æœ
python compare_runs_web.py --output-dir output
```

åœ¨ web ä¸­ï¼š
- å‹¾é€‰ `run_gpt4` å’Œ `run_claude`
- ç‚¹å‡» Load Comparison
- å¹¶æ’æŸ¥çœ‹ä¸¤ä¸ªæ¨¡å‹çš„è¾“å‡º

### æ¡ˆä¾‹ 2: éªŒè¯é‡‡æ ·é¢‘ç‡å½±å“

```bash
# ä¸åŒé‡‡æ ·é¢‘ç‡
python waymo_e2e_processor.py --sampling-frequency 1 --run-name run_1hz
python waymo_e2e_processor.py --sampling-frequency 2 --run-name run_2hz
python waymo_e2e_processor.py --sampling-frequency 5 --run-name run_5hz

# å¯¹æ¯”
python compare_runs_web.py --output-dir output
```

åœ¨ web ä¸­è§‚å¯Ÿä¸åŒé‡‡æ ·é¢‘ç‡çš„å¸§åˆ†å¸ƒå·®å¼‚ã€‚

### æ¡ˆä¾‹ 3: å¿«é€Ÿè´¨é‡æ£€æŸ¥

```bash
# å¤„ç†å°æ•°æ®é›†
python waymo_e2e_processor.py --max-frames 50 --run-name run_sample

# åœ¨ web ä¸­æµè§ˆ
python compare_runs_web.py --output-dir output
```

å¿«é€Ÿæ£€æŸ¥å¤„ç†ç»“æœçš„è´¨é‡ã€‚

## å‰ç½®æ¡ä»¶

### éœ€è¦å®‰è£… Flask

```bash
pip install flask
```

è‡ªåŠ¨è„šæœ¬ä¼šæ£€æŸ¥å¹¶è‡ªåŠ¨å®‰è£…ã€‚

### éœ€è¦æœ‰å¤„ç†è¿‡çš„æ•°æ®

è¿è¡Œæ•°æ®åº”è¯¥ä½äºï¼š

```
output/
â”œâ”€â”€ run_1/
â”‚   â”œâ”€â”€ results/
â”‚   â”‚   â”œâ”€â”€ {frame_name}.json
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ {frame_name}/
â”‚   â”‚   â”‚   â”œâ”€â”€ front_left.jpg
â”‚   â”‚   â”‚   â”œâ”€â”€ front.jpg
â”‚   â”‚   â”‚   â””â”€â”€ front_right.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ processing_order.json
â”œâ”€â”€ run_2/
â”‚   â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ images/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

**é‡è¦**ï¼šå¦‚æœéœ€è¦æ˜¾ç¤ºå›¾ç‰‡ï¼Œè¯·åœ¨å¤„ç†æ—¶å¯ç”¨ `save_images` é€‰é¡¹ï¼š

```yaml
# config.yaml
output:
  save_images: true
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•åœ¨ä¸åŒæœºå™¨é—´è®¿é—®ï¼Ÿ

A: å¯åŠ¨æ—¶æŒ‡å®š `--host 0.0.0.0`ï¼š

```bash
python compare_runs_web.py --output-dir output --host 0.0.0.0
```

ç„¶åä»å…¶ä»–æœºå™¨è®¿é—®ï¼š`http://{server_ip}:5000`

### Q: é¡µé¢åŠ è½½å¾ˆæ…¢ï¼Ÿ

A: å‡å°‘åŠ è½½çš„å¸§æ•°ï¼ˆé»˜è®¤ 100ï¼‰ï¼š

ç¼–è¾‘ `compare_runs_web.py`ï¼Œä¿®æ”¹ç¬¬ ~380 è¡Œï¼š

```python
comparison_data["frames"] = common_frames[:50]  # æ”¹ä¸º 50
```

### Q: æ²¡æœ‰å›¾ç‰‡æ˜¾ç¤ºï¼Ÿ

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

```bash
# 1. ç¡®è®¤å›¾ç‰‡ç›®å½•å­˜åœ¨
ls output/run_name/images/

# 2. ç¡®è®¤æœ‰å›¾ç‰‡æ–‡ä»¶
ls output/run_name/images/*/

# 3. å¦‚æœä¸ºç©ºï¼Œåœ¨ä¸‹æ¬¡å¤„ç†æ—¶å¯ç”¨ save_images
```

### Q: æ²¡æœ‰æ‰¾åˆ° runï¼Ÿ

A: æ£€æŸ¥ç›®å½•ç»“æ„ï¼š

```bash
# æŸ¥çœ‹æœ‰å“ªäº› run
ls -la output/

# ç¡®ä¿æ¯ä¸ª run éƒ½æœ‰ results/ ç›®å½•
ls output/run_1/results/
```

## å‘½ä»¤å‚è€ƒ

```bash
# æœ€åŸºç¡€ç”¨æ³•
python compare_runs_web.py

# æŒ‡å®šè¾“å‡ºç›®å½•
python compare_runs_web.py --output-dir /path/to/output

# æŒ‡å®šç«¯å£
python compare_runs_web.py --port 8080

# è¿œç¨‹è®¿é—®
python compare_runs_web.py --host 0.0.0.0 --port 5000

# å¯ç”¨è°ƒè¯•æ¨¡å¼
python compare_runs_web.py --debug

# ä½¿ç”¨å¯åŠ¨è„šæœ¬
./start_comparison_server.sh output
./start_comparison_server.sh /path/to/output
```

## é¡µé¢äº¤äº’è¯´æ˜

### é€‰æ‹© Run

```
â˜ run_20260202_120000
â˜‘ run_20260202_130000  â† é»˜è®¤å‹¾é€‰
â˜‘ run_20260202_140000  â† é»˜è®¤å‹¾é€‰
```

### åŠ è½½æ•°æ®

1. å‹¾é€‰æƒ³è¦å¯¹æ¯”çš„ run
2. ç‚¹å‡» **"Load Comparison"** æŒ‰é’®
3. ç­‰å¾…æ•°æ®åŠ è½½ï¼ˆæ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
4. å¸§å¡ç‰‡é€ä¸ªæ˜¾ç¤º

### æŸ¥çœ‹ç»“æœ

æ¯å¼ å¡ç‰‡å¯ä»¥ï¼š
- æŸ¥çœ‹åŸå§‹æ‘„åƒå¤´å›¾ç‰‡
- é˜…è¯» VLM ç”Ÿæˆçš„é“¾å¼æ¨ç†
- æŸ¥çœ‹è¡Œä¸ºé¢„æµ‹ï¼ˆé€Ÿåº¦ã€å‘½ä»¤ï¼‰
- æŸ¥çœ‹å…ƒæ•°æ®ï¼ˆæ—¶é—´æˆ³ã€æ¨¡å‹ã€çŠ¶æ€ï¼‰

## æ•°æ®æŸ¥çœ‹

### å›¾ç‰‡æ ¼å¼

æ”¯æŒ JPEG æ ¼å¼å›¾ç‰‡ï¼Œè‡ªåŠ¨æŒ‰å±å¹•å¤§å°ç¼©æ”¾æ˜¾ç¤ºã€‚

### VLM æ•°æ®æ ¼å¼

å·¥å…·è‡ªåŠ¨è¯†åˆ«å¹¶ç¾åŒ–æ˜¾ç¤ºï¼š

**æ ¼å¼ 1ï¼šç»“æ„åŒ–åˆ†æ**
```json
{
  "explanation": "The ego vehicle decelerates...",
  "meta_behaviour": {
    "speed": "decelerate",
    "command": "yield"
  }
}
```

**æ ¼å¼ 2ï¼šè‡ªç”±æ–‡æœ¬**
```
The vehicle is decelerating because...
```

**æ ¼å¼ 3ï¼šå…¶ä»– JSON**
è‡ªåŠ¨ç¾åŒ–å¹¶é«˜äº®æ˜¾ç¤ºã€‚

## æ€§èƒ½æç¤º

- ğŸ“± å“åº”å¼è®¾è®¡ - é€‚é…å„ç§å±å¹•å¤§å°
- âš¡ å¿«é€ŸåŠ è½½ - ä½¿ç”¨ Base64 ç¼–ç çš„å›¾ç‰‡
- ğŸ’¾ å†…å­˜ä¼˜åŒ– - é™åˆ¶ä¸€æ¬¡åŠ è½½çš„å¸§æ•°
- ğŸ”„ æµç•…ä½“éªŒ - CSS åŠ¨ç”»å’Œè¿‡æ¸¡

## æµè§ˆå™¨å…¼å®¹æ€§

âœ… Chrome / Chromiumï¼ˆæ¨èï¼‰
âœ… Firefox
âœ… Safari
âœ… Edge

å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ä»¥è·å¾—æœ€ä½³ä½“éªŒã€‚

## å®Œæ•´æŒ‡å—

è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œè¿›é˜¶é…ç½®ï¼Œè§ [WEB_COMPARISON_GUIDE.md](WEB_COMPARISON_GUIDE.md)

## æ€»ç»“

ä½¿ç”¨ 3 ä¸ªå‘½ä»¤å¿«é€Ÿå¯åŠ¨å¯¹æ¯”å·¥å…·ï¼š

```bash
# 1. å¯åŠ¨
./start_comparison_server.sh output

# 2. æ‰“å¼€
# http://127.0.0.1:5000

# 3. å¯¹æ¯”
# åœ¨ web ä¸­é€‰æ‹©å’Œæµè§ˆ
```

å®Œæˆï¼ğŸ‰

